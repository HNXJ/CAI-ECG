<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2019b"><title>12-Lead Classification of ECG signals</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: center;  }
.S1 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: center;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S3 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S8 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }</style></head><body><div class = rtcContent><h3  class = 'S0'><span>Computational AI Project - Phase1 - Fuzzy classification</span></h3><h1  class = 'S1'><span>12-Lead Classification of ECG signals</span></h1><div  class = 'S2'><img class = "imageNode" src = "data:image/jpeg;base64,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" alt = "" style = "vertical-align: baseline"></img></div><div  class = 'S2'><span>Computational AI course, Dr. Mehdi Rezaei</span></div><div  class = 'S2'><span>Hamed Nejat - 96102578</span></div><div  class = 'S2'><span>2020/4/21</span></div><h2  class = 'S3'><span>12-leads Data/Label loading</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>clear;clc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>datasize = 529;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>folderpath = </span><span style="color: rgb(160, 32, 240);">'project data assignment\Nejat'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>data = zeros(datasize, 12, 5000);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>label = zeros(datasize, 9);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>Begin = 4761; </span><span style="color: rgb(119, 172, 48);">% from 4762</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>bpf1 = designfilt(</span><span style="color: rgb(160, 32, 240);">'bandpassiir'</span><span>,</span><span style="color: rgb(160, 32, 240);">'FilterOrder'</span><span>, 2, </span><span style="color: rgb(222, 125, 0);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'HalfPowerFrequency1'</span><span>, 0.5,</span><span style="color: rgb(160, 32, 240);">'HalfPowerFrequency2'</span><span>, 200, </span><span style="color: rgb(222, 125, 0);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'SampleRate'</span><span>,500);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span style="color: rgb(222, 125, 0);">for </span><span>i = 1:529</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    dataAdd = [folderpath, </span><span style="color: rgb(160, 32, 240);">'\A'</span><span>, num2str(i+Begin), </span><span style="color: rgb(160, 32, 240);">'.mat'</span><span>];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    headAdd = [folderpath, </span><span style="color: rgb(160, 32, 240);">'\A'</span><span>, num2str(i+Begin), </span><span style="color: rgb(160, 32, 240);">'.hea'</span><span>];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    load(dataAdd);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    data(i, :, 1:min(5000, size(val,2))) = filter(bpf1, val(:, 1:min(5000, size(val, 2))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    headt = fopen(headAdd,</span><span style="color: rgb(160, 32, 240);">'r'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    c = textscan(headt,</span><span style="color: rgb(160, 32, 240);">'%s'</span><span>,</span><span style="color: rgb(160, 32, 240);">'delimiter'</span><span>,</span><span style="color: rgb(160, 32, 240);">'\n'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    d = c{1,1};</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    d = d(16);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    fclose(headt);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'AF'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 1) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'I-AVB'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 2) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'LBBB'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 3) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'Normal'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 4) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'PAC'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 5) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'PVC'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 6) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'RBBB'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 7) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'STD'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 8) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">if </span><span>contains(d,</span><span style="color: rgb(160, 32, 240);">'STE'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        label(i, 9) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(222, 125, 0);">end</span></span></div></div></div><h2  class = 'S3'><span>Feature extraction and signal filtering</span></h2><div  class = 'S7'><span>Butterworth BandpassIIR filters are used in all parts, also in GUI. The extracted features in this part are listed bellow, all of these features are time-frequency domain features.</span></div><div  class = 'S7'><span>I. Heart rate in BPM</span></div><div  class = 'S7'><span>II. Heart beat time period variance</span></div><div  class = 'S7'><span>III. Heart beat amplitude peak variance</span></div><div  class = 'S7'><span>IV. Specific wavelet (autocorrelation) of random period of signal's amplitude variance</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>clc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>Fs = 500;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>leads = 6:12;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>ids = 1:529;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>l = min(leads) - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>sobelKernel = [-1, -1, -1, -1, 1, 1, 1, 1];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>autoCorrFeatures = zeros(529, size(leads, 2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>heartBeats = zeros(529, size(leads, 2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>beatPeriodsSTD = zeros(529, size(leads, 2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>amplVar = zeros(529, size(leads, 2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>bpf2 = designfilt(</span><span style="color: rgb(160, 32, 240);">'bandpassiir'</span><span>,</span><span style="color: rgb(160, 32, 240);">'FilterOrder'</span><span>, 2, </span><span style="color: rgb(222, 125, 0);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'HalfPowerFrequency1'</span><span>, 0.5,</span><span style="color: rgb(160, 32, 240);">'HalfPowerFrequency2'</span><span>, 200, </span><span style="color: rgb(222, 125, 0);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'SampleRate'</span><span>,500);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(222, 125, 0);">for </span><span>i = ids</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">for </span><span>k = leads</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        x = squeeze(filter(bpf2, data(i, k, 500:3500)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        edges = conv(sobelKernel, x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        edges = edges + abs(edges);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        edges = (edges*100)/max(edges);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        [Ampls, Times] = findpeaks(edges);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        signific = Ampls &gt; 75;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Ampls = Ampls(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Times = Times(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        t1 = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        t2 = 500;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">if </span><span>size(Times, 2) &gt; 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>            t1 = Times(1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>            t2 = Times(2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        amplVar(i,k-l) = std(Ampls);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">if </span><span>size(Times, 2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>            heartBeats(i,k-l) = (Fs*size(Ampls,2)*60)/(Times(end)-Times(1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>            heartBeats(i,k-l) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Ts = Times(2:end) - Times(1:end-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        beatPeriodsSTD(i, k-l) = std(Ts);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = x(t1:t2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rxx = conv(rcorr, x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rxx = (100*rxx)/max(rxx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = conv(sobelKernel, rxx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = rcorr*100/max(rcorr);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = rcorr + abs(rcorr);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        [Ampls, Times] = findpeaks(rcorr);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        signific = Ampls &gt; 75;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Ampls = Ampls(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        autoCorrFeatures(i, k-l) = var(Ampls);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>heartRate = median(heartBeats, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>heartPeriodSTD = median(beatPeriodsSTD, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>amplVar = median(amplVar, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>autoCorrAmpVar = median(autoCorrFeatures, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(119, 172, 48);">% save('HR.mat', 'heartRate', 'heartPeriodSTD', 'amplVar', 'autoCorrAmpVar', 'data', 'bpf2', 'label');</span></span></div></div></div><h2  class = 'S3'><span>STQ waveform features</span></h2><div  class = 'S7'><span>As mentioned in the report, STD and STE and RBBB are well diagnosed by STQ interval statistics, so here we extract T-wave features, again by a singleton phi function of wavelet, using simple autocorrelation.</span></div><div  class = 'S7'><span>V. ST level variance in leads</span></div><div  class = 'S7'><span>VI. ST mean in leads</span></div><div  class = 'S7'><span>VII. ST risetimes in leads</span></div><h2  class = 'S3'><span>ST interval second and first order statistics</span></h2><div  class = 'S7'><span>With autocorrelation, we extract an scale of </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>clc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(119, 172, 48);">% load('HR.mat');</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>STwaveVar = zeros(529,6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>STwaveMean = zeros(529,6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>STwaveTime = zeros(529,6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>sobelKernel = [-1, -1, -1, -1, 1, 1, 1, 1];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>Fs = 500;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>leads = 3:10;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>ids = 1:529;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>l = min(leads) - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(222, 125, 0);">for </span><span>i = ids</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">for </span><span>k = leads</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        x = squeeze(filter(bpf2, data(i, k-l,:)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        edges = conv(sobelKernel, x, </span><span style="color: rgb(160, 32, 240);">'same'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        edges = edges + abs(edges);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        edges = (100*edges)/max(edges);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        [Ampls, Times] = findpeaks(edges);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        signific = Ampls &gt; 75;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Times = Times(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        t1 = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        t2 = 500;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">if </span><span>size(Times,2) &gt; 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>            t1 = Times(1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>            t2 = Times(2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = x(t1:t2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rxx = conv(rcorr, x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rxx = (100*rxx)/max(rxx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = conv(sobelKernel, rxx);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = (rcorr*100)/max(rcorr);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        rcorr = (rcorr + abs(rcorr))/2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        [Ampls, Times] = findpeaks(rcorr);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        signific = Ampls &gt; 8;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Ampls = Ampls(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Times = Times(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        signific = Ampls &lt; 36;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Ampls = Ampls(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        Times = Times(signific);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        STwaveVar(i, k-l) = var(Ampls);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        STwaveMean(i, k-l) = mean(Ampls);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>        STwaveTime(i,k) = var(Times(2:end)-Times(1:end-1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>    </span><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(222, 125, 0);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>STVar = median(STwaveVar, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>STMean = median(STwaveMean, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>STTimeVar = median(STwaveTime, 2, </span><span style="color: rgb(160, 32, 240);">'omitnan'</span><span>);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>X = cat(2, STVar, STTimeVar, STMean, heartRate, heartPeriodSTD, autoCorrAmpVar, amplVar);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>Y = label;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>save(</span><span style="color: rgb(160, 32, 240);">'TrainData.mat'</span><span>, </span><span style="color: rgb(160, 32, 240);">'X'</span><span>, </span><span style="color: rgb(160, 32, 240);">'Y'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>clear;clc;</span></span></div></div></div><h1  class = 'S8'><span>Training phase</span></h1><div  class = 'S7'><span>In this part, we load training data prepared in previous parts and train the ANFIS system using them:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>clear;clc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>load(</span><span style="color: rgb(160, 32, 240);">'TrainData.mat'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>X(isinf(X)|isnan(X)) = 0;</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>x = cat(2, X(:, :), Y(:, 1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>xtrain = x(1:500, :);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>xvalid = x(501:end, :);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>opt = anfisOptions(</span><span style="color: rgb(160, 32, 240);">'InitialFIS'</span><span>, 10,</span><span style="color: rgb(160, 32, 240);">'EpochNumber'</span><span>, 5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>opt.DisplayANFISInformation = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>opt.DisplayErrorValues = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>opt.DisplayStepSize = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>opt.DisplayFinalResults = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>opt.ValidationData = xvalid;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>[fis, trainError, stepSize, chkFIS, chkError] = anfis(xtrain, opt);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre;"><span>anfisOutput = evalfis(fis, x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>plot(x(:, 8), </span><span style="color: rgb(160, 32, 240);">'*r'</span><span>, anfisOutput,</span><span style="color: rgb(160, 32, 240);">'.b'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>legend(</span><span style="color: rgb(160, 32, 240);">'Training Data'</span><span>,</span><span style="color: rgb(160, 32, 240);">'ANFIS Output'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Location'</span><span>,</span><span style="color: rgb(160, 32, 240);">'NorthWest'</span><span>);</span></span></div></div></div><h1  class = 'S8'><span>END</span></h1></div>
<br>
<!-- 
##### SOURCE BEGIN #####
% Computational AI Project - Phase1 - Fuzzy classification
%% 12-Lead Classification of ECG signals
% 
% 
% Computational AI course, Dr. Mehdi Rezaei
% 
% Hamed Nejat - 96102578
% 
% 2020/4/21
%% 12-leads Data/Label loading

clear;clc;
datasize = 529;

folderpath = 'project data assignment\Nejat';
data = zeros(datasize, 12, 5000);
label = zeros(datasize, 9);
Begin = 4761; % from 4762

bpf1 = designfilt('bandpassiir','FilterOrder', 2, ...
        'HalfPowerFrequency1', 0.5,'HalfPowerFrequency2', 200, ...
        'SampleRate',500);
%%
for i = 1:529
    
    dataAdd = [folderpath, '\A', num2str(i+Begin), '.mat'];
    headAdd = [folderpath, '\A', num2str(i+Begin), '.hea'];
    load(dataAdd);
    data(i, :, 1:min(5000, size(val,2))) = filter(bpf1, val(:, 1:min(5000, size(val, 2))));
    
    headt = fopen(headAdd,'r');
    c = textscan(headt,'%s','delimiter','\n');
    d = c{1,1};
    d = d(16);
    fclose(headt);
    
    if contains(d,'AF')
        label(i, 1) = 1;
    end
    if contains(d,'I-AVB')
        label(i, 2) = 1;
    end
    if contains(d,'LBBB')
        label(i, 3) = 1;
    end
    if contains(d,'Normal')
        label(i, 4) = 1;
    end
    if contains(d,'PAC')
        label(i, 5) = 1;
    end
    if contains(d,'PVC')
        label(i, 6) = 1;
    end
    if contains(d,'RBBB')
        label(i, 7) = 1;
    end
    if contains(d,'STD')
        label(i, 8) = 1;
    end
    if contains(d,'STE')
        label(i, 9) = 1;
    end
    
end
%% Feature extraction and signal filtering
% Butterworth BandpassIIR filters are used in all parts, also in GUI. The extracted 
% features in this part are listed bellow, all of these features are time-frequency 
% domain features.
% 
% I. Heart rate in BPM
% 
% II. Heart beat time period variance
% 
% III. Heart beat amplitude peak variance
% 
% IV. Specific wavelet (autocorrelation) of random period of signal's amplitude 
% variance

clc;

Fs = 500;
leads = 6:12;
ids = 1:529;
l = min(leads) - 1;

sobelKernel = [-1, -1, -1, -1, 1, 1, 1, 1];

autoCorrFeatures = zeros(529, size(leads, 2));
heartBeats = zeros(529, size(leads, 2));
beatPeriodsSTD = zeros(529, size(leads, 2));
amplVar = zeros(529, size(leads, 2));

bpf2 = designfilt('bandpassiir','FilterOrder', 2, ...
        'HalfPowerFrequency1', 0.5,'HalfPowerFrequency2', 200, ...
        'SampleRate',500);

for i = ids
    for k = leads
        x = squeeze(filter(bpf2, data(i, k, 500:3500)));
        edges = conv(sobelKernel, x);
        edges = edges + abs(edges);
        
        edges = (edges*100)/max(edges);
        [Ampls, Times] = findpeaks(edges);
        
        signific = Ampls > 75;
        Ampls = Ampls(signific);
        Times = Times(signific);
        t1 = 1;
        t2 = 500;
        
        if size(Times, 2) > 1
            t1 = Times(1);
            t2 = Times(2);
        end
        
        amplVar(i,k-l) = std(Ampls);
        if size(Times, 2)
            heartBeats(i,k-l) = (Fs*size(Ampls,2)*60)/(Times(end)-Times(1));
        else
            heartBeats(i,k-l) = NaN;
        end
        
        Ts = Times(2:end) - Times(1:end-1);
        beatPeriodsSTD(i, k-l) = std(Ts);
        
        rcorr = x(t1:t2);
        rxx = conv(rcorr, x);
        rxx = (100*rxx)/max(rxx);
        
        rcorr = conv(sobelKernel, rxx);
        rcorr = rcorr*100/max(rcorr);
        
        rcorr = rcorr + abs(rcorr);
        
        [Ampls, Times] = findpeaks(rcorr);
        signific = Ampls > 75;
        Ampls = Ampls(signific);
        autoCorrFeatures(i, k-l) = var(Ampls);

    end
end

heartRate = median(heartBeats, 2, 'omitnan');
heartPeriodSTD = median(beatPeriodsSTD, 2, 'omitnan');
amplVar = median(amplVar, 2, 'omitnan');
autoCorrAmpVar = median(autoCorrFeatures, 2, 'omitnan');

% save('HR.mat', 'heartRate', 'heartPeriodSTD', 'amplVar', 'autoCorrAmpVar', 'data', 'bpf2', 'label');
%% STQ waveform features
% As mentioned in the report, STD and STE and RBBB are well diagnosed by STQ 
% interval statistics, so here we extract T-wave features, again by a singleton 
% phi function of wavelet, using simple autocorrelation.
% 
% V. ST level variance in leads
% 
% VI. ST mean in leads
% 
% VII. ST risetimes in leads
%% ST interval second and first order statistics
% With autocorrelation, we extract an scale of 

clc;
% load('HR.mat');

STwaveVar = zeros(529,6);
STwaveMean = zeros(529,6);
STwaveTime = zeros(529,6);

sobelKernel = [-1, -1, -1, -1, 1, 1, 1, 1];

Fs = 500;
leads = 3:10;
ids = 1:529;
l = min(leads) - 1;

for i = ids
    for k = leads
        x = squeeze(filter(bpf2, data(i, k-l,:)));
        edges = conv(sobelKernel, x, 'same');
        edges = edges + abs(edges);
        edges = (100*edges)/max(edges);
        
        [Ampls, Times] = findpeaks(edges);
        signific = Ampls > 75;
        Times = Times(signific);
        t1 = 1;
        t2 = 500;
    
        if size(Times,2) > 1
            t1 = Times(1);
            t2 = Times(2);
        end
        
        rcorr = x(t1:t2);
        rxx = conv(rcorr, x);
        rxx = (100*rxx)/max(rxx);
        
        rcorr = conv(sobelKernel, rxx);
        rcorr = (rcorr*100)/max(rcorr);
        
        rcorr = (rcorr + abs(rcorr))/2;
        
        [Ampls, Times] = findpeaks(rcorr);
        signific = Ampls > 8;
        Ampls = Ampls(signific);
        Times = Times(signific);
        
        signific = Ampls < 36;
        Ampls = Ampls(signific);
        Times = Times(signific);
        
        STwaveVar(i, k-l) = var(Ampls);
        STwaveMean(i, k-l) = mean(Ampls);
        STwaveTime(i,k) = var(Times(2:end)-Times(1:end-1));
    end
end

STVar = median(STwaveVar, 2, 'omitnan');
STMean = median(STwaveMean, 2, 'omitnan');
STTimeVar = median(STwaveTime, 2, 'omitnan');
%%
X = cat(2, STVar, STTimeVar, STMean, heartRate, heartPeriodSTD, autoCorrAmpVar, amplVar);
Y = label;
save('TrainData.mat', 'X', 'Y');
clear;clc;
%% Training phase
% In this part, we load training data prepared in previous parts and train the 
% ANFIS system using them:

clear;clc;
load('TrainData.mat');
X(isinf(X)|isnan(X)) = 0;
%%
x = cat(2, X(:, :), Y(:, 1));
xtrain = x(1:500, :);
xvalid = x(501:end, :);

opt = anfisOptions('InitialFIS', 10,'EpochNumber', 5);
opt.DisplayANFISInformation = 1;
opt.DisplayErrorValues = 1;
opt.DisplayStepSize = 1;

opt.DisplayFinalResults = 1;
opt.ValidationData = xvalid;
[fis, trainError, stepSize, chkFIS, chkError] = anfis(xtrain, opt);
%%
anfisOutput = evalfis(fis, x);
plot(x(:, 8), '*r', anfisOutput,'.b');
legend('Training Data','ANFIS Output','Location','NorthWest');
%% END
##### SOURCE END #####
--></body></html>